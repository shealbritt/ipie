
The following have been reloaded with a version change:
  1) Mambaforge/23.3.1-fasrc01 => Mambaforge/22.11.1-fasrc01
  2) python/3.10.12-fasrc01 => python/3.10.9-fasrc01

/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
Traceback (most recent call last):
  File "/n/home06/mbritt/VAFQMC/importancevafqmc/pes.py", line 30, in <module>
    run_simulation(dist)
  File "/n/home06/mbritt/VAFQMC/importancevafqmc/pes.py", line 25, in run_simulation
    opt_params = prop.run()
                 ^^^^^^^^^^
  File "/n/home06/mbritt/VAFQMC/importancevafqmc/hmc_vafqmc_lbfgs.py", line 397, in run
    res = scipy.optimize.minimize(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 731, in minimize
    res = _minimize_lbfgsb(fun, x0, args, jac, bounds,
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/scipy/optimize/_lbfgsb_py.py", line 407, in _minimize_lbfgsb
    f, g = func_and_grad(x)
           ^^^^^^^^^^^^^^^^
  File "/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 343, in fun_and_grad
    self._update_fun()
  File "/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 294, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 20, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home06/mbritt/VAFQMC/importancevafqmc/hmc_vafqmc_lbfgs.py", line 327, in objective_func
    samples, acceptance = jax.lax.stop_gradient(self.sampler(params, warmup))
                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home06/mbritt/VAFQMC/importancevafqmc/hmc_vafqmc_lbfgs.py", line 157, in sampler
    init_overlap = self.target(init_x_reshaped)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home06/mbritt/VAFQMC/importancevafqmc/hmc_vafqmc_lbfgs.py", line 130, in target
    overlapa, overlapb = self.get_overlap(*wfs)
                         ^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home06/mbritt/VAFQMC/importancevafqmc/hmc_vafqmc_lbfgs.py", line 188, in get_overlap
    print('overlapa', self.l_tensora)
                      ^^^^^^^^^^^^^^
AttributeError: 'Propagator' object has no attribute 'l_tensora'. Did you mean: 'l_tensor'?
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.

 Nonpositive definiteness in Cholesky factorization in formk;
   refresh the lbfgs memory and restart the iteration.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
/n/home06/mbritt/.conda/envs/afqmc_env/lib/python3.12/site-packages/jax/_src/lax/lax.py:2745: ComplexWarning: Casting complex values to real discards the imaginary part
  x_bar = _convert_element_type(x_bar, x.aval.dtype, x.aval.weak_type)
 This problem is unconstrained.
